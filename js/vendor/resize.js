(function(e){function r(t){this.filter(r.resizableFilterSelector).each(function(){new i(e(this),t)});return this}function i(t,n){t.data("AutoResizer")&&t.data("AutoResizer").destroy();n=this.config=e.extend({},r.defaults,n);this.el=t;this.nodeName=t[0].nodeName.toLowerCase();this.originalHeight=t.height();this.previousScrollTop=null;this.value=t.val();n.maxWidth==="original"&&(n.maxWidth=t.width());n.minWidth==="original"&&(n.minWidth=t.width());n.maxHeight==="original"&&(n.maxHeight=t.height());n.minHeight==="original"&&(n.minHeight=t.height());this.nodeName==="textarea"&&t.css({resize:"none",overflowY:"hidden"});t.data("AutoResizer",this);n.animate.complete=function(e){return function(){n.onAfterResize.call(t);return e.apply(this,arguments)}}(n.animate.complete);this.bind()}var t="ar"+ +(new Date),n=r.defaults={onResize:function(){},onBeforeResize:function(){return 123},onAfterResize:function(){return 555},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};r.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","paddingTop","paddingLeft","paddingBottom","paddingRight","width"];r.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden"};r.resizableFilterSelector=["textarea:not(textarea."+t+")","input:not(input[type])","input[type=text]","input[type=password]","input[type=email]","input[type=tel]","input[type=url]"].join(",");r.AutoResizer=i;e.fn.autoResize=r;i.prototype={bind:function(){var t=e.proxy(function(){this.check();return!0},this);this.unbind();this.el.bind("keyup.autoResize",t).bind("change.autoResize",t).bind("paste.autoResize",function(){setTimeout(function(){t()},0)});this.el.is(":hidden")||this.check(null,!0)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var n=this.el,i=this.nodeName==="textarea"?n.clone():e("<span/>");this.clone=i;e.each(r.cloneCSSProperties,function(e,t){i[0].style[t]=n.css(t)});i.removeAttr("name").removeAttr("id").addClass(t).attr("tabIndex",-1).css(r.cloneCSSValues);this.nodeName==="textarea"?i.height("auto"):i.width("auto").css({whiteSpace:"nowrap"})},check:function(e,t){if(!this.clone){this.createClone();this.injectClone()}var n=this.config,r=this.clone,i=this.el,s=i.val();if(s===this.prevValue)return!0;this.prevValue=s;if(this.nodeName==="input"){r.text(s);var o=r.width(),u=o+n.extraSpace>=n.minWidth?o+n.extraSpace:n.minWidth,a=i.width();u=Math.min(u,n.maxWidth);if(u<a&&u>=n.minWidth||u>=n.minWidth&&u<=n.maxWidth){n.onBeforeResize.call(i);n.onResize.call(i);i.scrollLeft(0);if(n.animate&&!t)i.stop(1,1).animate({width:u},n.animate);else{i.width(u);n.onAfterResize.call(i)}}return}r.width(i.width()).height(0).val(s).scrollTop(1e4);var f=r[0].scrollTop;if(!s){f=n.minHeight;this.previousScrollTop=null}else{if(this.previousScrollTop===f)return;this.previousScrollTop=f;if(f+n.extraSpace>=n.maxHeight){i.css("overflowY","");f=n.maxHeight;t=!0}else if(f+n.extraSpace<=n.minHeight)f=n.minHeight;else{i.css("overflowY","hidden");f+=n.extraSpace}}n.onBeforeResize.call(i);n.onResize.call(i);if(n.animate&&!t)i.stop(1,1).animate({height:f},n.animate);else{i.height(f);n.onAfterResize.call(i)}},destroy:function(){this.unbind();this.el.removeData("AutoResizer");this.clone.remove();delete this.el;delete this.clone},injectClone:function(){(r.cloneContainer||(r.cloneContainer=e("<arclones/>").appendTo("body"))).append(this.clone)}}})(jQuery);